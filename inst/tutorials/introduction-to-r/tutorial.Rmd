---
title: Introduction
author: David Kane
tutorial:
  id: introduction-to-r
output:
  learnr::tutorial:
    progressive: yes
    allow_skip: yes
runtime: shiny_prerendered
description: Tutorial for introducing students to the R language.
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(knitr)
library(tidyverse)

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(out.width = '90%')
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 

scat_p <- ggplot(data = mpg, 
                 mapping = aes(x = displ, 
                               y = hwy)) +
  geom_point(alpha = 0.5, color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency of Select Car Models",
       subtitle = "Cars with greater engineer displacement are less fuel efficient",
        x = "Engine Displacement (L)",
        y = "Highway Efficiency (mpg)", 
       caption = "EPA (2008)")
```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

<!-- Make this tutorial better. Make sure there are no mistakes. Make sure it is clear.  Do some reminding of stuff from Getting Started from tutorial.helpers. -->

<!-- Switch questions to using the Console, at least much of the time, instead of the exercise block? -->

## Introduction
### 

This tutorial will introduce you to the R language. Our approach is inspired by [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. You will learn how to work with data sets using the **[tidyverse](https://tidyverse.tidyverse.org/)** package. You will learn how to direct the result of one function to another using the pipe -- `|>` --- and how to make a quality plot using the `ggplot()` function.

### 

This tutorial assumes that you have already completed the "Getting Started" tutorial in the [**tutorial.helpers**](https://ppbds.github.io/tutorial.helpers/) package. If you haven't, do so now. It is quick!

### 

Start a new window with `File -> New Window`. This new window is the location in which you will do all the work for the tutorial, including the creation of new projects. The current window, the one in which you are reading these words, is just used to run this tutorial. 

## Working with data
### 

Learn how to explore a data set using functions like `summary()`, `glimpse()`, and `slice_sample()`. 

### Exercise 1

The steps of a typical data science project looks something like this:

```{r}
knitr::include_graphics("images/base.png")
```

### 

Looking at the graphic above, the first step in a data science project is to import your data into R. This typically means that you take data stored in a file, database, or web application programming interface (API) and load it into a data frame in R. If you can’t get your data into R, you can’t do data science on it!

###

Before you start doing data science, you must load the packages you are going to use. Use the function `library()` to load the **tidyverse** package.

```{r working-with-data-1, exercise = TRUE}

```

```{r working-with-data-1-hint-1, eval = FALSE}
library(...)
```

```{r working-with-data-1-test, include = FALSE}
library(tidyverse)
```

### 

"Library" and "package" mean the same thing in R. We have different words for historical reasons. However, only the `library()` command will load a package/library, giving us access to the functions and data which it contains.

The check mark which has appeared next to "Exercise 1" above indicates that you have submitted your answer. It doesn't verify that you have answered the question correctly.

### Exercise 2

In this tutorial, you will mostly be entering code into the exercise blocks, as you did above. But we will sometimes ask you to run code from the Console. (You will do this in the other Positron window, since the Console in this window is currently busy running the tutorial.) Example:

In the Console, run `library(tidyverse)`.

With Console questions, we will usually ask you to **c**opy/**p**aste the **c**ommand/**r**esponse into an answer block, like the one below. We usually shorten those instructions as CP/CR. Do that now.


```{r working-with-data-2}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 8)
```

###

Your answer should look like:

````
> library(tidyverse)
── Attaching core tidyverse packages ──────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package to force all conflicts to become errors
> 
````

Your answer never needs to match ours perfectly. Our goal is just to ensure that you are actually following the instructions.


### Exercise 3

Data frames, also referred to as "tibbles", are spreadsheet-type data sets. Type `diamonds` in the line below.

```{r working-with-data-3, exercise = TRUE}

```

```{r working-with-data-3-hint-1, eval = FALSE}
diamonds
```

```{r working-with-data-3-test, include = FALSE}
diamonds
```

### 

After importing your data, it is a good idea to **tidy** it. Tidying your data means storing it in a consistent form that matches the semantics of the dataset with how it is stored. 

### Exercise 4

Run `summary()` on `diamonds`. This function provides a quick statistics overview of each variable in the data set. 

```{r working-with-data-4, exercise = TRUE}

```

```{r working-with-data-4-hint-1, eval = FALSE}
summary(...)
```

```{r working-with-data-4-test, include = FALSE}
summary(diamonds)
```

### 

When your data is tidy, each column is a variable and each row is an observation. Tidy data is important because the consistent structure lets you focus your efforts on answering questions about the data, not fighting to get the data into the right form for different functions. 

### Exercise 5

Run `slice_sample()` on `diamonds`. This selects a random row from the data set.

```{r working-with-data-5, exercise = TRUE}

```

```{r working-with-data-5-hint-1, eval = FALSE}
slice_sample(...)
```

```{r working-with-data-5-test, include = FALSE}
slice_sample(diamonds)
```

Once you have tidy data, a common next step is to **transform** it. Transformation includes narrowing in on observations of interest (like all the people in one city or all the data from the last year), creating new variables that are functions of existing variables (like computing speed from distance and time), and calculating a set of summary statistics (like counts or means). 

### Exercise 6

Copy/paste the code above, but add the argument `n = 10` to `slice_sample()`. This will return 10 random rows from the `diamonds` data set.

```{r working-with-data-6, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r working-with-data-6-hint-1, eval = FALSE}
slice_sample(..., n = 10)
```

```{r working-with-data-6-test, include = FALSE}
slice_sample(diamonds, n = 10)
```

### 

Together, tidying and transforming are called **wrangling** because getting your data in a form that’s natural to work with often feels like a fight! 

### Exercise 7

Run `print()` on `diamonds`. This returns the same result as typing `diamonds` in the exercise block. 

```{r working-with-data-7, exercise = TRUE}

```

```{r working-with-data-7-hint-1, eval = FALSE}
...(diamonds)
```

```{r working-with-data-7-test, include = FALSE}
print(diamonds)
```

### 

You can choose how many rows to display by using the `n` argument in the `print()` function, and how many columns to display by using the `width` argument.

### Exercise 8

Run `print()` on `diamonds` with the argument `n = 3`. This returns the first 3 rows of the `diamonds` data set.

```{r working-with-data-8, exercise = TRUE}

```

```{r working-with-data-8-hint-1, eval = FALSE}
print(..., n = 3)
```

```{r working-with-data-8-test, include = FALSE}
print(diamonds, n = 3)
```

### 

The `diamonds` data set contains 53,940 rows and 10 columns. Each row represents a single diamond, and each column represents a different characteristic of that diamond. 

### Exercise 9

At the Console, run `?diamonds`.

This will look up the help page for the `diamonds` tibble from the **ggplot2** package, which is one of the core packages in the *[Tidyverse](https://www.tidyverse.org/)*. The help page will appear on the right-side of your Positron window, in the Secondary Activity Bar, which you might need to activate in order to see. 

Copy/paste the Description section of the help page below.

```{r working-with-data-9}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 5)
```
### 

You can find help about an entire package with `help(package = "ggplot2")`. It is confusing, but unavoidable, that package names are sometimes unquoted, as in `library(ggplot2)`, and sometimes quoted, as in `help(package = "ggplot2")`. If one does not work, try the other.

### Exercise 10

Run `glimpse()` on `diamonds`. 

```{r working-with-data-10, exercise = TRUE}

```

```{r working-with-data-10-hint-1, eval = FALSE}
...(diamonds)
```

```{r working-with-data-10-test, include = FALSE}
glimpse(diamonds)
```

### 

`glimpse()` displays columns running down the page and the data running across across. Note how the "type" of each variable is listed next to the variable name. For example, `price` is listed as `<int>`, meaning that it is an integer variable. To learn more about the `glimpse()` function, run `?glimpse`.

`view()` is another useful function, but, just because it is interactive, we should not use it within a tutorial. 

### Exercise 11

If you are ever stuck while coding, R has *help pages*. Let's say we want to know what the function `sqrt()` does. Open the help page for `sqrt()` by typing `?sqrt` in the Console. Copy/paste the Description below:

```{r working-with-data-11}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 5)
```

### 

<!-- DK: -->

### Exercise 12

In the Console, run:

````
x <- sqrt(144)
````

CP/CR.

```{r working-with-data-12}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 5)
```

###

The symbol `<-` is the assignment operator. In this case, we are *assigning* the value of `sqrt(144)` to the variable `x`.


## Creating a graphic
### 

Let's create the following scatterplot from the `mpg` dataset, which provides measurements of attributes from various car models.

```{r scat-p}
scat_p
```

### Exercise 1

In the Console, run `?mpg` to look up the help page for the `mpg` tibble from the **ggplot2** package. Copy/paste the Description below:

```{r creating-a-graphic-1}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 7)
```

###

````
This dataset contains a subset of the fuel economy data that the EPA makes available on https://fueleconomy.gov/. It contains only models which had a new release every year between 1999 and 2008 - this was used as a proxy for the popularity of the car.
````

### Exercise 2

Run `glimpse()` on `mpg`. 

```{r creating-a-graphic-2, exercise = TRUE}

```

```{r creating-a-graphic-2-hint-1, eval = FALSE}
glimpse(...)
```

```{r creating-a-graphic-2-test, include = FALSE}
glimpse(mpg)
```

### 

We will use `displ` and `hwy` to create the plot.

### Exercise 3

Referring to what pops up when you run `?mpg`, describe in your own words what `displ` and `hwy` stand for? 

```{r creating-a-graphic-3}
question_text(NULL,
	message = "In the `mpg` data set, `displ` stands for engine displacement, measured in litres while `hwy` stands for highway miles per gallon.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

<!-- DK: -->

### Exercise 4

Run `ggplot()`, setting `data` equal to `mpg`.

```{r creating-a-graphic-4, exercise = TRUE}

```

```{r creating-a-graphic-4-hint-1, eval = FALSE}
...(data = mpg)
```

```{r creating-a-graphic-4-test, include = FALSE}
ggplot(data = mpg)
```

###

`ggplot()` initializes a ggplot object. Your output should be an empty screen.

### Exercise 5

The first argument to `ggplot()` is `data`, as above. The second argument is `mapping`. Set the `mapping` to equal `aes()`, which is the "aesthetics" function for plotting.

```{r creating-a-graphic-5, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-5-hint-1, eval = FALSE}
ggplot(data = mpg, ... = ...())
```

```{r creating-a-graphic-5-test, include = FALSE}
ggplot(data = mpg, mapping = aes())
```

###

This produces the same blank canvas as above. We need to specify some arguments to `aes()` in order to generate the plot.

### Exercise 6

The two most important arguments in `aes()` are `x` and `y`. Set `x` equal to `displ`. Set `y` equal to `hwy`.

```{r creating-a-graphic-6, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-6-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = ...,
                     y = ...))
```

```{r creating-a-graphic-6-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, 
                     y = hwy))
```

### 

Anything included in `aes()` brings some information from the data in our tibble onto the graph. In this case, `displ` (a measure of the size of a car's engine) goes on the x axis and `hwy` (miles per gallon for highway driving) goes on the y-axis. 

R can also see the range of values in `mpg` for both `displ` and `hwy`, thereby determining the range of values which the axes should cover.

### Exercise 7

Let's now add the layer `geom_point()`. Steps within a series of plotting commands are connected by plus signs (`+`).

```{r creating-a-graphic-7, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-7-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ,
                     y = hwy)) +
  geom_...()
```

```{r creating-a-graphic-7-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ,
                     y = hwy)) +
  geom_point()
```

### 

`geom_*` functions, such as `geom_point()`, add additional layers to the base ggplot. This allows us to create a graphic piece-by-piece.

### Exercise 8

The code above uses the `mpg` tibble to create a scatterplot that displays 126 points, however, it visualizes a data set that contains 234 points. Because many points share the same values, this causes individual data points to be hidden behind other points. This is also known as **overplotting.**

One method to fight overplotting is to make each point **semi-transparent**. Change the transparency of the points by setting `alpha` equal to `0.5` within the call to `geom_point()`.

```{r creating-a-graphic-8, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-8-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, 
                     y = hwy)) +
  ...(alpha = 0.5)
```

```{r creating-a-graphic-8-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5)
```

### 

`alpha` only changes the appearance of the graph and does not add new information from the data. Thus, this argument is within the `geom` and is not nested within a call to `aes()`.

### Exercise 9

Now, also within `geom_point()`, set `color` equal to `"steelblue"`.

```{r creating-a-graphic-9, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-9-hint-1, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, 
                     y = hwy)) +
  geom_point(alpha = ..., 
             color = "...")
```

```{r creating-a-graphic-9-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue")
```

### 

R has 657 (built in color names)[https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf?page=3]. Like `alpha`, `color` also is not changing the data so the argument is within `geom`.

### Exercise 10

Now, use `labs()` to add the title to to the graph using the argument `title`. Reminder: This is what our graph should look like.

```{r}
scat_p
```

```{r creating-a-graphic-10, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-10-hint-1, eval = FALSE}
... + 
  labs(title = "...")
```

```{r creating-a-graphic-10-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency for Selected Car Models")
```

### 

This book proudly and primarily focuses on small, in-memory datasets. This is the right place to start because you can’t tackle big data unless you have experience with small data.

### Exercise 11

Add the `subtitle` to the graph using the argument `subtitle`. 

```{r creating-a-graphic-11, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-11-hint-1, eval = FALSE}
... +
  labs(title = "...", 
       subtitle = "...")
```

```{r creating-a-graphic-11-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency for Selected Car Models",
       subtitle = "Cars with greater engine displacement are less fuel efficient")
```

### 

The subtitle should be the one sentence of information about the graph with which you would hope a reader walks away. What is the most important fact demonstrated in the graphic? 

### Exercise 12

Set `x` to `"Engine Displacement (L)"`.

```{r creating-a-graphic-12, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-12-hint-1, eval = FALSE}
... +
  labs(title = "...", 
       subtitle = "...", 
       x = "...")
```

```{r creating-a-graphic-12-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency for Selected Car Models",
       subtitle = "Cars with greater engine displacement are less fuel efficient",
       x = "Engine Displacement (L)")
```

### 

The tools you’ll learn throughout the majority of this book and thue tutorials will easily handle hundreds of megabytes of data, and with a bit of care, you can typically use them to work with a few gigabytes of data.

### Exercise 13

Set `y` to `"Highway Efficiency (mpg)"`. 

```{r creating-a-graphic-13, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-13-hint-1, eval = FALSE}
... +
  labs(title = "...", 
       subtitle = "...", 
       x = "...", 
       y = "...")
```

```{r creating-a-graphic-13-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency for Selected Car Models",
       subtitle = "Cars with greater engine displacement are less fuel efficient",
       x = "Engine Displacement (L)",
       y = "Highway Efficiency (mpg)")
```

### 

We’ll also show you how to get data out of databases and parquet files, both of which are often used to store big data. You won’t necessarily be able to work with the entire dataset, but that’s not a problem because you only need a subset or subsample to answer the question that you’re interested in.

### Exercise 14

Finally, set the `caption` to `"EPA (2008)"`. The caption is a place where you credit the source of your data.

```{r creating-a-graphic-14, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r creating-a-graphic-14-hint-1, eval = FALSE}
... +
  labs(title = "...", 
       subtitle = "...", 
       x = "...", 
       y = "...", 
       caption = "...")
```

```{r creating-a-graphic-14-test, include = FALSE}
ggplot(data = mpg, 
       mapping = aes(
         x = displ,
         y = hwy)) +
  geom_point(alpha = .5, 
             color = "steelblue") +
  labs(title = "Measurements for Engine Displacement and Highway Fuel Efficiency for Selected Car Models",
       subtitle = "Cars with greater engine displacement are less fuel efficient",
       x = "Engine Displacement (L)",
       y = "Highway Efficiency (mpg)",
       caption = "EPA (2008)")
```

### 

Large data sets (10-100GB, say), uses a different interface than the tidyverse and requires you to learn some different conventions. If you are interested, we recommend learning more about [data.table](https://github.com/Rdatatable/data.table)


## Running R code
### 

Although the *Tidyverse* includes hundreds of commands, the most important are `filter()`, `select()`, `arrange()`, `mutate()`, and `summarize()`. Whenever you face a new problem, try to think about which one of these commands might be a good way to start.

### Exercise 1

Let's warm up by examining the `gss_cat` tibble from the **forcats** package. Since **forcats** is a core **tidyverse** package, you have already loaded it. Type `gss_cat` and hit "Run Code."

```{r running-r-code-1, exercise = TRUE}

```

```{r running-r-code-1-hint-1, eval = FALSE}
...
```

```{r running-r-code-1-test, include = FALSE}
gss_cat
```

### 

Whenever we print a tibble, the number of rows and columns is displayed at the top:

````
A tibble: 21,483 × 9
````

You can also see the variable type under each of the column names.

### Exercise 2

Run `summary()` on `gss_cat`. 

```{r running-r-code-2, exercise = TRUE}

```

```{r running-r-code-2-hint-1, eval = FALSE}
summary(...)
```

```{r running-r-code-2-test, include = FALSE}
summary(gss_cat)
```

### 

Note that there are missing values in some columns. The word `NA` stands for "Not Available" and is used to represent missing data in R.

### Exercise 3

Pipe `gss_cat` to `drop_na()`. This function removes rows with missing values. 

```{r running-r-code-3, exercise = TRUE}

```

```{r running-r-code-3-hint-1, eval = FALSE}
... |> 
  drop_na()
```

```{r running-r-code-3-test, include = FALSE}
gss_cat |> 
  drop_na()
```

### 

Note the number of rows in the tibble after `drop_na()`. Since `drop_na()` removes rows with missing values, the number of rows in the tibble will be less than the original number of rows.

````
A tibble: 11,299 × 9
````

### Exercise 4

Run `?forcats::gss_cat` in the Console. This should work even if you have not loaded the **forcats** package. The double colon --- `::` --- notation allows us to access the inside of a package even if we have not loaded it.

Copy/paste the Description.

```{r running-r-code-4}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Throughout these tutorials, we use a consistent set of conventions to refer to code:

Functions are displayed in a code font and followed by parentheses, like `sum()` or `mean()`.

Other R objects (such as data or function arguments) are in a code font, without parentheses, like `flights` or `x`.

Sometimes, to make it clear which package an object comes from, we’ll use the package name followed by two colons, like `dplyr::mutate()` or `nycflights13::flights`. This is also valid R code.

### Exercise 5

Recall that the `+` sign is used to **"chain"** different pieces of plot creation code together. When doing data analysis, we use the "pipe" symbol --- `|>` --- to do the same thing between different pieces code which manipulate the data.

As a simple example, "pipe" the `gss_cat` tibble to the `print()` command.  


```{r running-r-code-5, exercise = TRUE}

```

```{r running-r-code-5-hint-1, eval = FALSE}
... |> 
  print()
```

```{r running-r-code-5-test, include = FALSE}
gss_cat |> 
  print()
```

### 

Note the language. We write "pipe this to that." That is, we pipe the `gss_cat` tibble to the `print()` command. This accomplishes the same effect as simply running `print(gss_cat)`, but allows us to string together several commands in a row.


### Exercise 6

Pipe `gss_cat` to `filter()`.  Within `filter()`, use the argument `age > 88`. 

```{r running-r-code-6, exercise = TRUE}

```

```{r running-r-code-6-hint-1, eval = FALSE}
gss_cat |> 
  ...(age > 88)
```

```{r running-r-code-6-test, include = FALSE}
gss_cat |> 
  filter(age > 88)
```

### 

This workflow --- in which we pipe a tibble to a function, which then outputs another tibble, which we can then pipe to another function, and so on --- is very common in R programming.

The resulting tibble has the same number of columns --- `filter()` only affects the rows --- as `gss_cat` but many fewer rows, because there are only 150 people in the data older than 88.

### Exercise 7

Continue the code and pipe with `select()`, using the argument `age, marital, race, relig, tvhours`.


```{r running-r-code-7, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-7-hint-1, eval = FALSE}
... |> 
  select(age, ..., race, ..., tvhours)
```

```{r running-r-code-7-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours)
```

### 

Note how the Hint only gives the most recent line of the pipe. Because `select()` does not affect the rows, we have the same number as after `filter()`. But we only have 5 columns now, consistent with what we told `select()` to do.

### Exercise 8

Copy previous code. Continue the pipe with `summary()`

```{r running-r-code-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-8-hint-1, eval = FALSE}
... |> 
  summary()
```

```{r running-r-code-8-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  summary()
```

### 

Note that there are missing values in the `tvhours` column. Let's remove them.

### Exercise 9

Copy previous code. Replace the `summary()` with `drop_na()`.

```{r running-r-code-9, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-9-hint-1, eval = FALSE}
... |> 
  drop_na()
```

```{r running-r-code-9-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na()
```

### 

Note that the number of rows has decreased as we removed rows with missing values.

### Exercise 10

Continue the pipe with `arrange()`, using `tvhours` as the argument.

```{r running-r-code-10, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-10-hint-1, eval = FALSE}
... |> 
  arrange(...)
```

```{r running-r-code-10-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(tvhours)
```

### 

The `arrange()` function sorts the rows of a tibble. By default, it sorts in ascending order.

### Exercise 11

Copy the previous code. Put `desc()` around `tvhours` to sort in descending order.

```{r running-r-code-11, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-11-hint-1, eval = FALSE}
... |> 
  arrange(desc(...))
```

```{r running-r-code-11-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours))
```

### 

Got to respect someone who watches TV 18 hours a day!

<!-- DK: Use AI to make a plot. -->

### Exercise 12

Let's make a plot. Copy the previous code, and pipe to `ggplot()`. Set `aes(x = tvhours, y = age)`.

```{r running-r-code-12, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-12-hint-1, eval = FALSE}
... |> 
  ggplot(mapping = aes(x = ..., y = ...))
```

```{r running-r-code-12-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours)) |>
  ggplot(aes(x = tvhours, y = age))
```

### 

Note that this will return a plain graph as we have not mapped any data to the graph yet.

### Exercise 13

Add another layer with `geom_point()` using the `+` sign. 

```{r running-r-code-13, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-13-hint-1, eval = FALSE}
... + 
  geom_point()
```

```{r running-r-code-13-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours)) |>
  ggplot(aes(x = tvhours, y = age)) + 
  geom_point()
```

### 

This is a scatterplot of `tvhours` versus `age`. The x-axis is the number of hours of TV watched per day, and the y-axis is the age of the person.

### Exercise 14

Let's rescale the `y` axes. Add `scale_y_continuous(breaks = c(89), limits = c(89, 89))` to the code. 

```{r running-r-code-14, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-14-hint-1, eval = FALSE}

```

```{r running-r-code-14-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours)) |>
  ggplot(aes(x = tvhours, y = age)) + 
  geom_point() + 
  scale_y_continuous(breaks = c(89), limits = c(89, 89))
```

### 

By looking at the graph, we can see that most people watch TV for less than 10 hours a day. However, there is one person who watches TV for 18 hours a day.

### Exercise 15

Finally, add a title, subtitle, labels for x and y axes using `labs()`. Remember this is what your graph should look like.

```{r}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours)) |>
  ggplot(aes(x = tvhours, y = age)) + 
  geom_point() + 
  scale_y_continuous(breaks = c(89), limits = c(89, 89)) +
  labs(title = "TV Hours Watched by Age", 
       subtitle = "Got to respect someone who watches TV 18 hours a day!", 
       x = "TV Hours", 
       y = "Age")
```

```{r running-r-code-15, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r running-r-code-15-hint-1, eval = FALSE}
... + 
  labs(title = "...", 
       subtitle = "...", 
       x = "...", 
       y = "...")
```

```{r running-r-code-15-test, include = FALSE}
gss_cat |> 
  filter(age > 88) |> 
  select(age, marital, race, relig, tvhours) |>
  drop_na() |>
  arrange(desc(tvhours)) |>
  ggplot(aes(x = tvhours, y = age)) + 
  geom_point() + 
  scale_y_continuous(breaks = c(89), limits = c(89, 89)) +
  labs(title = "TV Hours Watched by Age", 
       subtitle = "Got to respect someone who watches TV 18 hours a day!", 
       x = "TV Hours", 
       y = "Age")
```

### 

Note that the code in the code block is not saved. If you want to save the code, you can copy/paste it into an R script file.



## Summary
### 

This tutorial introduced you to the R language. Our approach was inspired by [*R for Data Science (2e)*](https://r4ds.hadley.nz/) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. You learned how to work with data sets using the **[tidyverse](https://tidyverse.tidyverse.org/)** package. You learned how to direct the result of one function to another using the pipe -- `|>` --- and how to make a quality plot using the `ggplot()` function.

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
